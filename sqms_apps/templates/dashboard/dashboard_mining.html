<!DOCTYPE html>
<html lang="en">
{% load static %}

<head>
    {% include 'layout-new/head.html' %}
</head>

<body x-data="main" class="relative overflow-x-hidden font-nunito text-sm font-normal antialiased"
    :class="[ $store.app.sidebar ? 'toggle-sidebar' : '', $store.app.theme === 'dark' || $store.app.isDarkMode ?  'dark' : '', $store.app.menu, $store.app.layout,$store.app.rtlClass]">
    <!-- sidebar menu overlay -->
    <div x-cloak="" class="fixed inset-0 z-50 bg-[black]/60 lg:hidden" :class="{'hidden' : !$store.app.sidebar}"
        @click="$store.app.toggleSidebar()"></div>

    <!-- screen loader -->
    <div
        class="screen_loader animate__animated fixed inset-0 z-[60] grid place-content-center bg-[#fafafa] dark:bg-[#060818]">
        <svg width="64" height="64" viewbox="0 0 135 135" xmlns="http://www.w3.org/2000/svg" fill="#4361ee">
            <path
                d="M67.447 58c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10zm9.448 9.447c0 5.523 4.477 10 10 10 5.522 0 10-4.477 10-10s-4.478-10-10-10c-5.523 0-10 4.477-10 10zm-9.448 9.448c-5.523 0-10 4.477-10 10 0 5.522 4.477 10 10 10s10-4.478 10-10c0-5.523-4.477-10-10-10zM58 67.447c0-5.523-4.477-10-10-10s-10 4.477-10 10 4.477 10 10 10 10-4.477 10-10z">
                <animatetransform attributename="transform" type="rotate" from="0 67 67" to="-360 67 67" dur="2.5s"
                    repeatcount="indefinite"></animatetransform>
            </path>
            <path
                d="M28.19 40.31c6.627 0 12-5.374 12-12 0-6.628-5.373-12-12-12-6.628 0-12 5.372-12 12 0 6.626 5.372 12 12 12zm30.72-19.825c4.686 4.687 12.284 4.687 16.97 0 4.686-4.686 4.686-12.284 0-16.97-4.686-4.687-12.284-4.687-16.97 0-4.687 4.686-4.687 12.284 0 16.97zm35.74 7.705c0 6.627 5.37 12 12 12 6.626 0 12-5.373 12-12 0-6.628-5.374-12-12-12-6.63 0-12 5.372-12 12zm19.822 30.72c-4.686 4.686-4.686 12.284 0 16.97 4.687 4.686 12.285 4.686 16.97 0 4.687-4.686 4.687-12.284 0-16.97-4.685-4.687-12.283-4.687-16.97 0zm-7.704 35.74c-6.627 0-12 5.37-12 12 0 6.626 5.373 12 12 12s12-5.374 12-12c0-6.63-5.373-12-12-12zm-30.72 19.822c-4.686-4.686-12.284-4.686-16.97 0-4.686 4.687-4.686 12.285 0 16.97 4.686 4.687 12.284 4.687 16.97 0 4.687-4.685 4.687-12.283 0-16.97zm-35.74-7.704c0-6.627-5.372-12-12-12-6.626 0-12 5.373-12 12s5.374 12 12 12c6.628 0 12-5.373 12-12zm-19.823-30.72c4.687-4.686 4.687-12.284 0-16.97-4.686-4.686-12.284-4.686-16.97 0-4.687 4.686-4.687 12.284 0 16.97 4.686 4.687 12.284 4.687 16.97 0z">
                <animatetransform attributename="transform" type="rotate" from="0 67 67" to="360 67 67" dur="8s"
                    repeatcount="indefinite"></animatetransform>
            </path>
        </svg>
    </div>

    <!-- scroll to top button -->
    <div class="fixed bottom-6 z-50 ltr:right-6 rtl:left-6" x-data="scrollToTop">
        <template x-if="showTopButton">
            <button type="button"
                class="btn btn-outline-primary animate-pulse rounded-full bg-[#fafafa] p-2 dark:bg-[#060818] dark:hover:bg-primary"
                @click="goToTop">
                <svg width="24" height="24" class="h-4 w-4" viewbox="0 0 24 24" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path opacity="0.5" fill-rule="evenodd" clip-rule="evenodd"
                        d="M12 20.75C12.4142 20.75 12.75 20.4142 12.75 20L12.75 10.75L11.25 10.75L11.25 20C11.25 20.4142 11.5858 20.75 12 20.75Z"
                        fill="currentColor"></path>
                    <path
                        d="M6.00002 10.75C5.69667 10.75 5.4232 10.5673 5.30711 10.287C5.19103 10.0068 5.25519 9.68417 5.46969 9.46967L11.4697 3.46967C11.6103 3.32902 11.8011 3.25 12 3.25C12.1989 3.25 12.3897 3.32902 12.5304 3.46967L18.5304 9.46967C18.7449 9.68417 18.809 10.0068 18.6929 10.287C18.5768 10.5673 18.3034 10.75 18 10.75L6.00002 10.75Z"
                        fill="currentColor"></path>
                </svg>
            </button>
        </template>
    </div>

    <!-- start theme customizer section -->
    {% include 'layout-new/customizer.html' %}
    <!-- end theme customizer section -->

    <div class="main-container min-h-screen text-black dark:text-white-dark" :class="[$store.app.navbar]">
        <!-- start sidebar section -->
        {% include 'layout-new/sidebar.html' %}
        <!-- end sidebar section -->

        <div class="main-content flex flex-col min-h-screen">
            <!-- start header section -->
            {% include 'layout-new/header.html' %}
            <!-- end header section -->

            <div class="animate__animated p-6" :class="[$store.app.animation]">
                <div x-data="finance">
                    <!-- Menampilkan nama pengguna yang login -->
                    <div class="mt-4 text-lg text-gray-300">
                        <!-- Jika hanya ingin menampilkan nama pengguna (username) -->
                        <div class="mt-4 text-lg text-gray-600"> Welcome, {{ user.first_name }} </div>
                    </div>
                    <div class="mb-5 flex items-center">
                        <!-- <h5 class="text-lg font-semibold dark:text-white-light">Mtd - Ore Class</h5> -->
                        <div x-data="form" class="dropdown ltr:ml-auto rtl:mr-auto">
                            <div class="inline-flex">
                                <div>
                                    <select id="filter_year" name="filter_year" class="form-select text-white-dark">
                                        <option value="">-- Year --</option>
                                    </select>
                                </div>

                                <div class="dropdown">
                                    <select id="filter_month" name="filter_month" class="form-select text-white-dark">
                                        <option value="">Month</option>
                                        <option value="1">Januari</option>
                                        <option value="2">Februari</option>
                                        <option value="3">Maret</option>
                                        <option value="4">April</option>
                                        <option value="5">Mei</option>
                                        <option value="6">Juni</option>
                                        <option value="7">Juli</option>
                                        <option value="8">Agustus</option>
                                        <option value="9">September</option>
                                        <option value="10">Oktober</option>
                                        <option value="11">November</option>
                                        <option value="12">Desember</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Card Top -->
                    {% include 'dashboard/mining/view_top.html' %}
                </div>

                <!-- Call Chart Month to Date -->
                {% include 'dashboard/mining/view_mine_mtd.html' %}

                <!-- call chart this week & last  5 week -->
                {% include 'dashboard/mining/view_mine_weekly.html' %}
            </div>

            <!-- start footer section -->
            <div class="p-6 pt-0 mt-auto text-center dark:text-white-dark ltr:sm:text-left rtl:sm:text-right">
                © <span id="footer-year">2022</span>. SQMS All rights reserved.
            </div>
            <!-- end footer section -->
        </div>
    </div>

    <!-- JAVASCRIPT -->
    {% include "layout-new/js.html" %}


    <script>
        // main section
        document.addEventListener('alpine:init', () => {
            // content section
            Alpine.data('finance', () => ({
                init() {
                    isDark = this.$store.app.theme === 'dark' || this.$store.app.isDarkMode ? true : false;
                    isRtl = this.$store.app.rtlClass === 'rtl' ? true : false;
                    const chartYeartoDate = null;
                    const chartDailytoMonth = null;
                    const chartHourstoDaysMtd = null;
                    const chartMaterialDailytoMonth = null;
                    const chartMaterialtoDays = null;
                    const chartMaterialtoWeekly = null;
                    const chartMaterialtoWeek = null;

                    // Pass Header Token
                    $.ajaxSetup({
                        headers: {
                            "X-CSRFToken": $('meta[name="csrf-token"]').attr("content"),
                        },
                    });

                    // Fetch year options for ore
                    $.ajax({
                        url: "{% url 'get-year-ore' %}",
                        method: "GET",
                        dataType: "json",
                        success: (data) => {
                            let options = "";
                            $.each(data.tahun_pds, (key, value) => {
                                options += `<option value="${value.tahun}">${value.tahun}</option>`;
                            });
                            $("#filter_year").append(options);
                            $("#filter_mtd_ore").append(options);
                        },
                    });

                    // Fetch year options for sale
                    $.ajax({
                        url: "{% url 'get-year-sale' %}",
                        method: "GET",
                        dataType: "json",
                        success: (data) => {
                            let options = "";
                            $.each(data.tahun, (key, value) => {
                                options += `<option value="${value.tahun}">${value.tahun}</option>`;
                            });
                            $("#filter_year_sale").append(options);
                            $("#filter_mtd_sale").append(options);
                        },
                    });

                    // Fetch initial data and update chart
                    this.fetchDataPtd();
                    this.fetchDataYtd();
                    this.fetchDataMtd();
                    this.fetchDataWtd();
                    this.fetchDataCardYtd();
                    this.createYtdChart();
                    this.createDailyChart();
                    this.createHoursChart();
                    this.createMaterialMonthChart();
                    this.createMaterialDaysChart();
                    this.createMaterialWeeklyChart();
                    this.createMaterialWeekChart();

                    this.chartYeartoDate = new ApexCharts(this.$refs.chartYeartoDate, this.barOptions);
                    this.$refs.chartYeartoDate.innerHTML = '';
                    this.chartYeartoDate.render();

                    //  by Mont to date
                    this.chartDailytoMonth = new ApexCharts(this.$refs.chartDailytoMonth, this.dailyChartOptions);
                    this.$refs.chartDailytoMonth.innerHTML = '';
                    this.chartDailytoMonth.render();

                    this.chartHourstoDays = new ApexCharts(this.$refs.chartHourstoDays, this.mixedChartOptions);
                    this.$refs.chartHourstoDays.innerHTML = '';
                    this.chartHourstoDays.render();

                    this.chartMaterialDailytoMonth = new ApexCharts(this.$refs.chartMaterialDailytoMonth, this.mixedChartOptions);
                    this.$refs.chartMaterialDailytoMonth.innerHTML = '';
                    this.chartMaterialDailytoMonth.render();

                    this.chartMaterialtoDays = new ApexCharts(this.$refs.chartMaterialtoDays, this.mixedChartOptions);
                    this.$refs.chartMaterialtoDays.innerHTML = '';
                    this.chartMaterialtoDays.render();

                    this.chartMaterialtoWeekly = new ApexCharts(this.$refs.chartMaterialtoWeekly, this.mixedChartOptions);
                    this.$refs.chartMaterialtoWeekly.innerHTML = '';
                    this.chartMaterialtoWeekly.render();

                    this.chartMaterialtoWeek = new ApexCharts(this.$refs.chartMaterialtoWeek, this.mixedChartOptions);
                    this.$refs.chartMaterialtoWeek.innerHTML = '';
                    this.chartMaterialtoWeek.render();


                    // Watch for theme changes
                    this.$watch('$store.app.theme', () => {
                        this.isDark = this.$store.app.theme === 'dark' || this.$store.app.isDarkMode ? true : false;
                        this.updateChartTheme();
                    });

                    // Watch for RTL changes
                    this.$watch('$store.app.rtlClass', () => {
                        this.isRtl = this.$store.app.rtlClass === 'rtl' ? true : false;
                        this.updateChartTheme();
                    });

                    // Fetch data when filter changes

                    document.getElementById('filter_year').addEventListener('change', (event) => {
                        const selectedYearSale = event.target.value;
                        const filter = { filter_year: selectedYearSale };
                        this.fetchDataYtd(filter);
                        this.fetchDataCardYtd(filter);
                        this.createYtdChart(filter);
                    });


                    document.getElementById('filter_days').addEventListener('change', (event) => {
                        const selectedDate = event.target.value;
                        const filter = { filter_days: selectedDate };
                        this.createDailyChart(filter);
                        this.createMaterialMonthChart(filter);
                        this.createHoursChart(filter);
                        this.createMaterialDaysChart(filter);
                    });

                    document.getElementById('filter_month').addEventListener('change', (event) => {
                        const selectedMonth = event.target.value;
                        const selectedYear = $("#filter_year").val();;
                        var filter = {
                            filter_year: selectedYear,
                            filter_month: selectedMonth
                        };
                        this.fetchDataMtd(filter);

                    });


                },

                fetchDataPtd() {
                    $.ajax({
                        type: "GET",
                        url: '{% url "get-mine-category-ptd" %}',
                        success: function (data) {
                            // createLim(data)
                            var data_mining = data.mining;
                            var data_project = data.project;
                            var bcm_total = data.bcm_total;
                            var total = bcm_total.reduce((acc, curr) => acc + curr, 0); // Hitung total data

                            var mining_percentage = 0;
                            var project_percentage = 0;

                            // Periksa apakah total tidak nol sebelum menghitung persentase
                            if (total !== 0) {
                                mining_percentage = (data_mining / total) * 100;
                                project_percentage = (data_project / total) * 100;
                            }

                            function formatAngka(jumlah) {
                                if (jumlah >= 1_000_000_000) {
                                    return (jumlah / 1_000_000_000).toFixed(3) + ' B';
                                } else if (jumlah >= 1_000_000) {
                                    return (jumlah / 1_000_000).toFixed(3) + ' M';
                                } else if (jumlah >= 1_000) {
                                    return (jumlah / 1_000).toFixed(3) + ' K';
                                } else {
                                    return jumlah.toString();
                                }
                            }

                            $("#mining_ptd").html(formatAngka(data_mining));
                            $("#project_ptd").html(formatAngka(data_project));
                            // $("#mining_ptd_perc").html(mining_percentage.toFixed(1) + '%');
                            // $("#project_ptd_perc").html(project_percentage.toFixed(1) + '%');

                        },
                        error: function (xhr, errmsg, err) {
                            console.log("Error:", errmsg);
                        },
                    });
                },

                fetchDataYtd(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '{% url "get-mine-category-ytd" %}',
                        data: filter,
                        success: function (data) {
                            // createLim(data)
                            var data_mining = data.mining;
                            var data_project = data.project;
                            var bcm_total = data.bcm_total;
                            var total = bcm_total.reduce((acc, curr) => acc + curr, 0); // Hitung total data

                            var mining_percentage = 0;
                            var project_percentage = 0;

                            // Periksa apakah total tidak nol sebelum menghitung persentase
                            if (total !== 0) {
                                mining_percentage = (data_mining / total) * 100;
                                project_percentage = (data_project / total) * 100;
                            }

                            function formatAngka(jumlah) {
                                if (jumlah >= 1_000_000_000) {
                                    return (jumlah / 1_000_000_000).toFixed(3) + ' B';
                                } else if (jumlah >= 1_000_000) {
                                    return (jumlah / 1_000_000).toFixed(3) + ' M';
                                } else if (jumlah >= 1_000) {
                                    return (jumlah / 1_000).toFixed(3) + ' K';
                                } else {
                                    return jumlah.toString();
                                }
                            }

                            $("#mining_ytd").html(formatAngka(data_mining));
                            $("#project_ytd").html(formatAngka(data_project));
                            // $("#mining_ytd_perc").html(mining_percentage.toFixed(1) + '%');
                            // $("#project_ytd_perc").html(project_percentage.toFixed(1) + '%');

                        },
                        error: function (xhr, errmsg, err) {
                            console.log("Error:", errmsg);
                        },
                    });
                },

                fetchDataMtd(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '{% url "get-mine-category-mtd" %}',
                        data: filter,
                        success: function (data) {
                            // createLim(data)
                            var data_mining = data.mining;
                            var data_project = data.project;
                            var bcm_total = data.bcm_total;
                            var total = bcm_total.reduce((acc, curr) => acc + curr, 0); // Hitung total data

                            var mining_percentage = 0;
                            var project_percentage = 0;

                            // Periksa apakah total tidak nol sebelum menghitung persentase
                            if (total !== 0) {
                                mining_percentage = (data_mining / total) * 100;
                                project_percentage = (data_project / total) * 100;
                            }

                            function formatAngka(jumlah) {
                                if (jumlah >= 1_000_000_000) {
                                    return (jumlah / 1_000_000_000).toFixed(3) + ' B';
                                } else if (jumlah >= 1_000_000) {
                                    return (jumlah / 1_000_000).toFixed(3) + ' M';
                                } else if (jumlah >= 1_000) {
                                    return (jumlah / 1_000).toFixed(3) + ' K';
                                } else {
                                    return jumlah.toString();
                                }
                            }

                            $("#mining_mtd").html(formatAngka(data_mining));
                            $("#project_mtd").html(formatAngka(data_project));
                            // $("#mining_mtd_perc").html(mining_percentage.toFixed(1) + '%');
                            // $("#project_mtd_perc").html(project_percentage.toFixed(1) + '%');

                        },
                        error: function (xhr, errmsg, err) {
                            console.log("Error:", errmsg);
                        },
                    });
                },

                fetchDataWtd() {
                    $.ajax({
                        type: "GET",
                        url: '{% url "get-mine-category-wtd" %}',
                        success: function (data) {
                            // createLim(data)
                            var data_mining = data.mining;
                            var data_project = data.project;
                            var bcm_total = data.bcm_total;
                            var total = bcm_total.reduce((acc, curr) => acc + curr, 0); // Hitung total data

                            var mining_percentage = 0;
                            var project_percentage = 0;

                            // Periksa apakah total tidak nol sebelum menghitung persentase
                            if (total !== 0) {
                                mining_percentage = (data_mining / total) * 100;
                                project_percentage = (data_project / total) * 100;
                            }

                            function formatAngka(jumlah) {
                                if (jumlah >= 1_000_000_000) {
                                    return (jumlah / 1_000_000_000).toFixed(3) + ' B';
                                } else if (jumlah >= 1_000_000) {
                                    return (jumlah / 1_000_000).toFixed(3) + ' M';
                                } else if (jumlah >= 1_000) {
                                    return (jumlah / 1_000).toFixed(3) + ' K';
                                } else {
                                    return jumlah.toString();
                                }
                            }

                            $("#mining_wtd").html(formatAngka(data_mining));
                            $("#project_wtd").html(formatAngka(data_project));
                            // $("#mining_mtd_perc").html(mining_percentage.toFixed(1) + '%');
                            // $("#project_mtd_perc").html(project_percentage.toFixed(1) + '%');

                        },
                        error: function (xhr, errmsg, err) {
                            console.log("Error:", errmsg);
                        },
                    });
                },

                fetchDataCardYtd(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '{% url "get-mine-card-ytd" %}',
                        data: filter,
                        success: function (data) {
                            // createLim(data)
                            var TopSoil = data.TopSoil;
                            var OB = data.OB;
                            var LGLO = data.LGLO;
                            var MGLO = data.MGLO;
                            var HGLO = data.HGLO;
                            var Waste = data.Waste;
                            var MWS = data.MWS;
                            var LGSO = data.LGSO;
                            var MGSO = data.MGSO;
                            var HGSO = data.HGSO;
                            var Quarry = data.Quarry;
                            var Biomass = data.Biomass;

                            function formatAngka(jumlah) {
                                if (jumlah >= 1_000_000_000) {
                                    return (jumlah / 1_000_000_000).toFixed(3) + ' B';
                                } else if (jumlah >= 1_000_000) {
                                    return (jumlah / 1_000_000).toFixed(3) + ' M';
                                } else if (jumlah >= 1_000) {
                                    return (jumlah / 1_000).toFixed(3) + ' K';
                                } else {
                                    return jumlah.toString();
                                }
                            }
                            $("#topsoil_ytd").html(formatAngka(TopSoil));
                            $("#ob_ytd").html(formatAngka(OB));
                            $("#lglo_ytd").html(formatAngka(LGLO));
                            $("#mglo_ytd").html(formatAngka(MGLO));
                            $("#hglo_ytd").html(formatAngka(HGLO));
                            $("#waste_ytd").html(formatAngka(Waste));
                            $("#mws_ytd").html(formatAngka(MWS));
                            $("#lgso_ytd").html(formatAngka(LGSO));
                            $("#mgso_ytd").html(formatAngka(MGSO));
                            $("#hgso_ytd").html(formatAngka(HGSO));
                            $("#quarry_ytd").html(formatAngka(Quarry));
                            $("#biomass_ytd").html(formatAngka(Biomass));

                        },
                        error: function (xhr, errmsg, err) {
                            console.log("Error:", errmsg);
                        },
                    });
                },

                // Function Charts to fetch data from server 
                createYtdChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '{% url "get-mine-chart-ytd" %}',
                        data: filter,
                        success: (data) => { // Menggunakan arrow function di sini
                            // Panggil fungsi pembuatan grafik dengan data yang diperoleh
                            const x_data = data.x_data;
                            const y_actual = data.y_actual;
                            const y_plan = data.y_plan;

                            this.chartYeartoDate.updateOptions({

                                series: [
                                    {
                                        name: 'Actual',
                                        data: y_actual
                                    }, {
                                        name: 'Plan',
                                        data: y_plan

                                    }],
                                xaxis: {
                                    categories: x_data,
                                },
                                colors: ['#ffc107', "#405a88", "#b9decf"],
                                title: {
                                    text: 'Production Mine - Ytd',
                                    align: 'left'
                                },
                                plotOptions: {
                                    bar: {
                                        horizontal: false,
                                        columnWidth: '55%',
                                        // borderRadius: 5,
                                        borderRadiusApplication: 'end'
                                    },
                                },
                                dataLabels: {
                                    enabled: false
                                },
                                stroke: {
                                    show: true,
                                    width: 2,
                                    colors: ['transparent']
                                },

                            });
                        },
                        error: function (xhr, errmsg, err) {
                            console.log("Error:", errmsg);
                        },
                    });

                },

                createDailyChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '{% url "get-mine-chart-mtd" %}',
                        data: filter,
                        success: (data) => {
                            const x_data = data.x_data;
                            const y_plan = data.y_plan;
                            const y_actual = data.y_actual;
                            const totals_actual = data.actual_accumulated;
                            const totals_plan = data.plan_accumulated;

                            // Membuat data series untuk Actual
                            var seriesDataActual = [];
                            for (var i = 0; i < x_data.length; i++) {
                                seriesDataActual.push({
                                    x: x_data[i],
                                    y: y_actual[i],
                                });
                            }

                            // Membuat data series untuk Plan
                            var seriesDataPlan = [];
                            for (var i = 0; i < x_data.length; i++) {
                                seriesDataPlan.push({
                                    x: x_data[i],
                                    y: y_plan[i],
                                });
                            }

                            //accumulated
                            var seriesTotalsPlan = [];
                            for (var i = 0; i < x_data.length; i++) {
                                seriesTotalsPlan.push({
                                    x: x_data[i],
                                    y: totals_plan[i],
                                });
                            }
                            var seriesTotalsActual = [];
                            for (var i = 0; i < x_data.length; i++) {
                                seriesTotalsActual.push({
                                    x: x_data[i],
                                    y: totals_actual[i],
                                });
                            }

                            // Mengatur ulang data kategori dan data seri
                            this.chartDailytoMonth.updateOptions({
                                series: [
                                    {
                                        name: "Actual",
                                        data: seriesDataActual,
                                    },
                                    {
                                        name: "Plan",
                                        data: seriesDataPlan,
                                    },
                                    {
                                        name: "Accumulated Actual",
                                        data: seriesTotalsActual,
                                    },

                                    {
                                        name: "Accumulated Plan",
                                        data: seriesTotalsPlan,
                                    },

                                ],
                                title: {
                                    text: 'Productions this Month'
                                },

                                stroke: {
                                    show: true,
                                    curve: 'smooth',
                                    width: 2,
                                    lineCap: 'square',
                                    dashArray: [0, 0, 5, 5]
                                },

                                yaxis: [
                                    {
                                        tickAmount: 4,
                                        seriesName: 'Actual',
                                        axisTicks: {
                                            show: true,
                                        },
                                        tooltip: {
                                            enabled: true
                                        },
                                        labels: {
                                            formatter: (value) => {
                                                return value / 1000 + 'K';
                                            },
                                            offsetX: isRtl ? -30 : -10,
                                            offsetY: 0,
                                            style: {
                                                fontSize: '12px',
                                                cssClass: 'apexcharts-yaxis-title',
                                            },
                                        },
                                    },
                                    {
                                        // tickAmount: 4,
                                        seriesName: 'Plan',
                                        opposite: true,
                                        axisTicks: {
                                            show: true,
                                        },
                                        show: false

                                    },
                                    {
                                        // tickAmount: 4,
                                        seriesName: 'Accumulated Actual',
                                        opposite: true,
                                        axisTicks: {
                                            show: true,
                                        },
                                        show: false
                                    },
                                    {
                                        tickAmount: 4,
                                        seriesName: 'Accumulated Plan',
                                        opposite: true,
                                        axisTicks: {
                                            show: true,
                                        },
                                        labels: {
                                            formatter: (value) => {
                                                return value / 1000 + 'K';
                                            },
                                            offsetX: isRtl ? -30 : -10,
                                            offsetY: 0,
                                            style: {
                                                fontSize: '12px',
                                                cssClass: 'apexcharts-yaxis-title',
                                            },
                                        },
                                        show: true
                                    },
                                ],
                            });
                        },
                        error: function (error) {
                            console.error(error);
                        },
                    });
                },

                createHoursChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '{% url "get-mine-hours-daily" %}',
                        data: filter,
                        success: (data) => {
                            const x_data = data.x_data;
                            const y_actual = data.y_actual;
                            const y_plan = data.y_plan;

                            // Mengatur ulang data kategori dan data seri
                            this.chartHourstoDays.updateOptions({
                                series: [
                                    {
                                        "name": "Actual",
                                        "type": "column",
                                        "data": y_actual
                                    },
                                    {
                                        "name": "Plan",
                                        "type": "area",
                                        "data": y_plan
                                    }
                                ],
                                labels: x_data,
                                colors: ['#5c739a', '#ffca2c'],
                                dataLabels: {
                                    enabled: false,
                                },
                                stroke: {
                                    width: [0, 2],
                                    curve: 'smooth'
                                },
                                title: {
                                    text: 'Tracking - by Hours ',
                                    floating: true,
                                    offsetY: 0,
                                    align: 'center',
                                    style: {
                                        color: '#444'
                                    }
                                },
                                yaxis: [
                                    {
                                        labels: {
                                            formatter: (value) => {
                                                return value / 1000 + 'K';
                                            },
                                            style: {
                                                fontSize: '12px',
                                                cssClass: 'apexcharts-yaxis-title',
                                            },
                                        },
                                    }
                                ],

                                fill: {
                                    opacity: [0.89, 0.20],
                                    gradient: {
                                        inverseColors: false,
                                        shade: 'light',
                                        type: "vertical",
                                        opacityFrom: 0.85,
                                        opacityTo: 0.55,
                                        stops: [0, 100, 100, 100]
                                    }
                                },
                                responsive: [{
                                    breakpoint: 400,
                                    options: {
                                        chart: {
                                            width: 340
                                        },
                                        legend: {
                                            show: false
                                        }
                                    }
                                }],

                            });
                        },
                        error: function (error) {
                            console.error(error);
                        },
                    });


                },

                // Get Data by Materials
                createMaterialMonthChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '{% url "get-mine-material-mtd" %}',
                        data: filter,
                        success: (data) => {
                            const x_data = data.x_data;
                            const y_plan = data.y_plan;
                            const y_actual = data.y_actual;
                            // Mengatur ulang data kategori dan data seri
                            this.chartMaterialDailytoMonth.updateOptions({
                                series: [
                                    {
                                        "name": "Actual",
                                        "type": "column",
                                        "data": y_actual
                                    },
                                    {
                                        "name": "Plan",
                                        "type": "column",
                                        "data": y_plan
                                    }
                                ],
                                labels: x_data,
                                colors: ['#5c739a', '#ffca2c'],
                                dataLabels: {
                                    enabled: false,
                                },
                                stroke: {
                                    width: [0, 0]
                                },
                                title: {
                                    text: 'Material - by Month ',
                                    floating: true,
                                    offsetY: 0,
                                    align: 'center',
                                    style: {
                                        color: '#444'
                                    }
                                },
                                yaxis: [
                                    {
                                        labels: {
                                            formatter: (value) => {
                                                return value / 1000 + 'K';
                                            },
                                            offsetX: isRtl ? -30 : -10,
                                            offsetY: 0,
                                            style: {
                                                fontSize: '12px',
                                                cssClass: 'apexcharts-yaxis-title',
                                            },
                                        },
                                    }


                                ],
                                responsive: [{
                                    breakpoint: 400,
                                    options: {
                                        chart: {
                                            width: 340
                                        },
                                        legend: {
                                            show: false
                                        }
                                    }
                                }],

                            });
                        },
                        error: function (error) {
                            console.error(error);
                        },
                    });

                },

                createMaterialDaysChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '{% url "get-mine-material-days" %}',
                        data: filter,
                        success: (data) => {
                            const x_data = data.x_data;
                            const y_actual = data.y_actual;
                            const y_plan = data.y_plan;

                            // Mengatur ulang data kategori dan data seri
                            this.chartMaterialtoDays.updateOptions({

                                series: [
                                    {
                                        "name": "Actual",
                                        "type": "column",
                                        "data": y_actual
                                    },
                                    {
                                        "name": "Plan",
                                        "type": "column",
                                        "data": y_plan
                                    }
                                ],
                                labels: x_data,
                                colors: ['#5c739a', '#ffca2c'],
                                dataLabels: {
                                    enabled: false,
                                },
                                stroke: {
                                    width: [0, 0],
                                    curve: 'smooth'
                                },
                                title: {
                                    text: 'Tracking - by Hours ',
                                    floating: true,
                                    offsetY: 0,
                                    align: 'center',
                                    style: {
                                        color: '#444'
                                    }
                                },
                                yaxis: [
                                    {
                                        labels: {
                                            formatter: (value) => {
                                                return value / 1000 + 'K';
                                            },
                                            style: {
                                                fontSize: '12px',
                                                cssClass: 'apexcharts-yaxis-title',
                                            },
                                        },
                                    }
                                ],

                                fill: {
                                    opacity: [0.95, 0.65],
                                    gradient: {
                                        inverseColors: false,
                                        shade: 'light',
                                        type: "vertical",
                                        opacityFrom: 0.85,
                                        opacityTo: 0.55,
                                        stops: [0, 100, 100, 100]
                                    }
                                },
                                responsive: [{
                                    breakpoint: 400,
                                    options: {
                                        chart: {
                                            width: 340
                                        },
                                        legend: {
                                            show: false
                                        }
                                    }
                                }],


                            });
                        },
                        error: function (error) {
                            console.error(error);
                        },
                    });

                },

                // For Weekly
                createMaterialWeeklyChart(filter = {}) {
                    $.ajax({
                        url: '{% url "get-mine-weeks-analysis" %}',
                        data: filter,
                        success: (data) => {
                            const x_data = data.x_data;
                            const y_plan = data.y_plan;
                            const y_actual = data.y_actual;

                            // Mengatur ulang data kategori dan data seri
                            this.chartMaterialtoWeekly.updateOptions({

                                series: [
                                    {
                                        "name": "Actual",
                                        "type": "column",
                                        "data": y_actual
                                    },
                                    {
                                        "name": "Plan",
                                        "type": "column",
                                        "data": y_plan
                                    }
                                ],
                                labels: x_data,
                                title: {
                                    text: 'Material on Weekly ',
                                    floating: true,
                                    offsetY: 0,
                                    align: 'center',
                                    style: {
                                        color: '#444'
                                    }
                                },
                                colors: ['#5c739a', '#ffca2c'],
                                dataLabels: {
                                    enabled: false,
                                },
                                stroke: {
                                    width: [0, 0],
                                    curve: 'smooth'
                                },

                                yaxis: [
                                    {
                                        labels: {
                                            formatter: (value) => {
                                                return value / 1000 + 'K';
                                            },
                                            style: {
                                                fontSize: '12px',
                                                cssClass: 'apexcharts-yaxis-title',
                                            },
                                        },
                                    }
                                ],

                                fill: {
                                    opacity: [0.95, 0.65],
                                    gradient: {
                                        inverseColors: false,
                                        shade: 'light',
                                        type: "vertical",
                                        opacityFrom: 0.85,
                                        opacityTo: 0.55,
                                        stops: [0, 100, 100, 100]
                                    }
                                },
                                responsive: [{
                                    breakpoint: 400,
                                    options: {
                                        chart: {
                                            width: 340
                                        },
                                        legend: {
                                            show: false
                                        }
                                    }
                                }],


                            });
                        },
                        error: function (error) {
                            console.error(error);
                        },
                    });

                },

                createMaterialWeekChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '{% url "get-mine-on-weeks-analysis" %}',
                        success: (data) => {
                            const x_data = data.x_data;
                            const y_actual = data.y_actual;
                            const y_plan = data.y_plan;
                            // Mengatur ulang data kategori dan data seri
                            this.chartMaterialtoWeek.updateOptions({

                                series: [
                                    {
                                        "name": "Actual",
                                        "type": "column",
                                        "data": y_actual
                                    },
                                    {
                                        "name": "Plan",
                                        "type": "column",
                                        "data": y_plan
                                    }
                                ],
                                labels: x_data,
                                colors: ['#5c739a', '#ffca2c'],
                                dataLabels: {
                                    enabled: false,
                                },
                                stroke: {
                                    width: [0, 0],
                                    curve: 'smooth'
                                },
                                title: {
                                    text: 'Material - this week ',
                                    floating: true,
                                    offsetY: 0,
                                    align: 'center',
                                    style: {
                                        color: '#444'
                                    }
                                },
                                yaxis: [
                                    {
                                        labels: {
                                            formatter: (value) => {
                                                return value / 1000 + 'K';
                                            },
                                            style: {
                                                fontSize: '12px',
                                                cssClass: 'apexcharts-yaxis-title',
                                            },
                                        },
                                    }
                                ],

                                fill: {
                                    opacity: [0.95, 0.65],
                                    gradient: {
                                        inverseColors: false,
                                        shade: 'light',
                                        type: "vertical",
                                        opacityFrom: 0.85,
                                        opacityTo: 0.55,
                                        stops: [0, 100, 100, 100]
                                    }
                                },
                                responsive: [{
                                    breakpoint: 400,
                                    options: {
                                        chart: {
                                            width: 340
                                        },
                                        legend: {
                                            show: false
                                        }
                                    }
                                }],
                            });
                        },
                        error: function (error) {
                            console.error(error);
                        },
                    });

                },


                updateChartTheme() {
                    this.chartYeartoDate.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                        xaxis: {
                            axisBorder: { show: true, color: this.isDark ? '#3b3f5c' : '#e0e6ed' },
                        },
                    });
                    this.chartDailytoMonth.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                        // xaxis: {
                        //     axisBorder: { show: true, color: this.isDark ? '#3b3f5c' : '#e0e6ed' },
                        // },
                    });
                    this.chartHourstoDays.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                        // xaxis: {
                        //     axisBorder: { show: true, color: this.isDark ? '#3b3f5c' : '#e0e6ed' },
                        // },
                    });

                    this.chartMaterialDailytoMonth.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                    });
                    this.chartMaterialtoDays.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                    });

                    this.chartMaterialtoWeekly.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                    });
                    this.chartMaterialtoWeek.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                    });

                },

                get barOptions() {
                    return {
                        series: [
                            { name: 'HPAL', data: [] },
                            { name: 'RKEF', data: [] }
                        ],
                        chart: {
                            height: 320,
                            type: 'bar',
                            fontFamily: 'Nunito, sans-serif',
                            toolbar: {
                                show: false,
                            },
                        },
                        dataLabels: {
                            enabled: false,
                        },
                        stroke: {
                            width: 2,
                            colors: ['transparent'],
                        },
                        // colors: ['#5c1ac3', '#5c739a', '#ffbb44'],
                        colors: ['#ffca2c', '#5c739a', '#5c1ac3', '#ffbb44'],
                        // colors: ['#ffc107', '#546ea2', '#5c739a'],
                        dropShadow: {
                            enabled: true,
                            blur: 3,
                            color: '#515365',
                            opacity: 0.4,
                        },
                        plotOptions: {
                            bar: {
                                horizontal: false,
                                columnWidth: '70%',
                                borderRadius: 0,
                            },
                        },
                        legend: {
                            position: 'bottom',
                            horizontalAlign: 'center',
                            fontSize: '14px',
                            itemMargin: {
                                horizontal: 8,
                                vertical: 8,
                            },
                        },
                        grid: {
                            borderColor: isDark ? '#191e3a' : '#e0e6ed',
                            padding: {
                                left: 20,
                                right: 20,
                            },
                        },
                        xaxis: {
                            categories: [],
                            axisBorder: {
                                show: true,
                                color: isDark ? '#3b3f5c' : '#e0e6ed',
                            },
                        },
                        yaxis: {
                            tickAmount: 4,
                            labels: {
                                formatter: (value) => {
                                    return value / 1000 + 'K';
                                },
                                offsetX: isRtl ? -10 : 0,
                                offsetY: 0,
                                style: {
                                    fontSize: '12px',
                                    cssClass: 'apexcharts-yaxis-title',
                                },
                            },
                            opposite: isRtl ? true : false,
                        },
                        fill: {

                        },
                        tooltip: {
                            marker: {
                                show: true,
                            },
                            y: {
                                formatter: (val) => {
                                    return val;
                                },
                            },
                        },
                        noData: {
                            text: "No Data...",
                        },
                    };
                },

                // area chart
                get dailyChartOptions() {
                    return {
                        series: [
                            {
                                name: 'Actual',
                                data: [],
                            },
                            {
                                name: 'Plan',
                                data: [],
                            },
                        ],
                        chart: {
                            height: 325,
                            type: 'area',
                            fontFamily: 'Nunito, sans-serif',
                            zoom: {
                                enabled: false,
                            },
                            toolbar: {
                                show: false,
                            },
                        },
                        dataLabels: {
                            enabled: false,
                        },
                        stroke: {
                            show: true,
                            curve: 'smooth',
                            width: 2,
                            lineCap: 'square',
                        },
                        dropShadow: {
                            enabled: true,
                            opacity: 0.2,
                            blur: 10,
                            left: -7,
                            top: 22,
                        },
                        //  colors: isDark ? ['#2196f3', '#e7515a'] : ['#1b55e2', '#e7515a'],
                        colors: [],
                        labels: [],
                        xaxis: {
                            axisBorder: {
                                show: false,
                            },
                            axisTicks: {
                                show: false,
                            },
                            crosshairs: {
                                show: true,
                            },
                            labels: {
                                offsetX: isRtl ? 2 : 0,
                                offsetY: 5,
                                style: {
                                    fontSize: '12px',
                                    cssClass: 'apexcharts-xaxis-title',
                                },
                            },
                        },
                        yaxis: {
                            tickAmount: 5,
                            labels: {
                                formatter: (value) => {
                                    return value / 1000 + 'K';
                                },
                                offsetX: isRtl ? -30 : -10,
                                offsetY: 0,
                                style: {
                                    fontSize: '12px',
                                    cssClass: 'apexcharts-yaxis-title',
                                },
                            },
                            opposite: isRtl ? true : false,
                        },
                        grid: {
                            borderColor: isDark ? '#191e3a' : '#e0e6ed',
                            strokeDashArray: 0,
                            xaxis: {
                                lines: {
                                    show: false,
                                },
                            },
                            yaxis: {
                                lines: {
                                    show: true,
                                },
                            },
                            padding: {
                                top: 0,
                                right: 0,
                                bottom: 0,
                                left: 0,
                            },
                        },
                        legend: {
                            position: 'top',
                            horizontalAlign: 'right',
                            fontSize: '16px',
                            markers: {
                                width: 10,
                                height: 10,
                                offsetX: -2,
                            },
                            itemMargin: {
                                horizontal: 10,
                                vertical: 5,
                            },
                        },
                        tooltip: {
                            marker: {
                                show: true,
                            },
                            x: {
                                show: false,
                            },
                        },
                        fill: {
                            type: 'gradient',
                            gradient: {
                                shadeIntensity: 1,
                                inverseColors: !1,
                                opacityFrom: isDark ? 0.19 : 0.28,
                                opacityTo: 0.07,
                                stops: isDark ? [100, 100] : [45, 100],
                            },
                        },
                    };
                },

                get donutChartOptions() {
                    return {
                        series: [],
                        chart: {
                            height: 290,
                            type: 'donut',
                            zoom: {
                                enabled: false
                            },
                            toolbar: {
                                show: false
                            }
                        },
                        stroke: {
                            show: false,
                        },
                        labels: [],
                        colors: [],
                        responsive: [{
                            breakpoint: 400,
                            options: {
                                chart: {
                                    width: 320
                                }
                            }
                        }],
                        legend: {
                            position: 'bottom',
                        },
                    }
                },

                get mixedChartOptions() {
                    return {
                        series: [],
                        chart: {
                            height: 350,
                            type: 'line',
                            fontFamily: 'Nunito, sans-serif',
                            zoom: {
                                enabled: false,
                            },
                            toolbar: {
                                show: false,
                            },
                            animations: {
                                enabled: true,
                                easing: "easein",
                                speed: 800,
                                animateGradually: {
                                    enabled: true,
                                    delay: 150,
                                },
                                dynamicAnimation: {
                                    enabled: true,
                                    speed: 350,
                                },
                            },
                        },
                        stroke: {
                            width: [0, 3]
                        },
                        title: {
                            text: 'Mine Productions'
                        },
                        dataLabels: {
                            enabled: true,
                            enabledOnSeries: [1]
                        },
                        labels: [],
                        yaxis: []
                    };

                },
            }));

        });
    </script>

</body>

</html>

<style>
    .scrollbar-sm {
        overflow-x: hidden;
        /* Scroll disembunyikan secara default */
        transition: overflow 0.3s;
        scroll-behavior: smooth;
        /* Scroll smooth */
        -webkit-overflow-scrolling: touch;
        /* Smooth scroll untuk iOS */
        margin-top: 16px;
        margin-bottom: 16px;
    }

    .scrollbar-sm:hover {
        overflow-x: auto;
        /* Scroll muncul saat hover */
    }

    .scrollbar-sm::-webkit-scrollbar {
        height: 6px;
        /* Scroll kecil */
    }

    .scrollbar-sm::-webkit-scrollbar-thumb {
        background-color: #888;
        border-radius: 3px;
    }

    .scrollbar-sm::-webkit-scrollbar-thumb:hover {
        background-color: #555;
    }

    @media (max-width: 768px) {
        .scrollbar-sm {
            display: flex;
            overflow-x: auto;
            padding-left: 8px;
            /* Perkecil padding */
            padding-right: 8px;
        }

        .scrollbar-sm>div {
            min-width: 150px;
            /* Sesuaikan ukuran card */
        }
    }
</style>