<!DOCTYPE html>
<html lang="en">
{% load static %}

<head>
    {% include 'layout-new/head.html' %}
</head>

<body x-data="main" class="relative overflow-x-hidden font-nunito text-sm font-normal antialiased"
    :class="[ $store.app.sidebar ? 'toggle-sidebar' : '', $store.app.theme === 'dark' || $store.app.isDarkMode ?  'dark' : '', $store.app.menu, $store.app.layout,$store.app.rtlClass]">
    <!-- sidebar menu overlay -->
    <div x-cloak="" class="fixed inset-0 z-50 bg-[black]/60 lg:hidden" :class="{'hidden' : !$store.app.sidebar}"
        @click="$store.app.toggleSidebar()"></div>

    <!-- screen loader -->
    <div
        class="screen_loader animate__animated fixed inset-0 z-[60] grid place-content-center bg-[#fafafa] dark:bg-[#060818]">
        <svg width="64" height="64" viewbox="0 0 135 135" xmlns="http://www.w3.org/2000/svg" fill="#4361ee">
            <path
                d="M67.447 58c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10zm9.448 9.447c0 5.523 4.477 10 10 10 5.522 0 10-4.477 10-10s-4.478-10-10-10c-5.523 0-10 4.477-10 10zm-9.448 9.448c-5.523 0-10 4.477-10 10 0 5.522 4.477 10 10 10s10-4.478 10-10c0-5.523-4.477-10-10-10zM58 67.447c0-5.523-4.477-10-10-10s-10 4.477-10 10 4.477 10 10 10 10-4.477 10-10z">
                <animatetransform attributename="transform" type="rotate" from="0 67 67" to="-360 67 67" dur="2.5s"
                    repeatcount="indefinite"></animatetransform>
            </path>
            <path
                d="M28.19 40.31c6.627 0 12-5.374 12-12 0-6.628-5.373-12-12-12-6.628 0-12 5.372-12 12 0 6.626 5.372 12 12 12zm30.72-19.825c4.686 4.687 12.284 4.687 16.97 0 4.686-4.686 4.686-12.284 0-16.97-4.686-4.687-12.284-4.687-16.97 0-4.687 4.686-4.687 12.284 0 16.97zm35.74 7.705c0 6.627 5.37 12 12 12 6.626 0 12-5.373 12-12 0-6.628-5.374-12-12-12-6.63 0-12 5.372-12 12zm19.822 30.72c-4.686 4.686-4.686 12.284 0 16.97 4.687 4.686 12.285 4.686 16.97 0 4.687-4.686 4.687-12.284 0-16.97-4.685-4.687-12.283-4.687-16.97 0zm-7.704 35.74c-6.627 0-12 5.37-12 12 0 6.626 5.373 12 12 12s12-5.374 12-12c0-6.63-5.373-12-12-12zm-30.72 19.822c-4.686-4.686-12.284-4.686-16.97 0-4.686 4.687-4.686 12.285 0 16.97 4.686 4.687 12.284 4.687 16.97 0 4.687-4.685 4.687-12.283 0-16.97zm-35.74-7.704c0-6.627-5.372-12-12-12-6.626 0-12 5.373-12 12s5.374 12 12 12c6.628 0 12-5.373 12-12zm-19.823-30.72c4.687-4.686 4.687-12.284 0-16.97-4.686-4.686-12.284-4.686-16.97 0-4.687 4.686-4.687 12.284 0 16.97 4.686 4.687 12.284 4.687 16.97 0z">
                <animatetransform attributename="transform" type="rotate" from="0 67 67" to="360 67 67" dur="8s"
                    repeatcount="indefinite"></animatetransform>
            </path>
        </svg>
    </div>

    <!-- scroll to top button -->
    <div class="fixed bottom-6 z-50 ltr:right-6 rtl:left-6" x-data="scrollToTop">
        <template x-if="showTopButton">
            <button type="button"
                class="btn btn-outline-primary animate-pulse rounded-full bg-[#fafafa] p-2 dark:bg-[#060818] dark:hover:bg-primary"
                @click="goToTop">
                <svg width="24" height="24" class="h-4 w-4" viewbox="0 0 24 24" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path opacity="0.5" fill-rule="evenodd" clip-rule="evenodd"
                        d="M12 20.75C12.4142 20.75 12.75 20.4142 12.75 20L12.75 10.75L11.25 10.75L11.25 20C11.25 20.4142 11.5858 20.75 12 20.75Z"
                        fill="currentColor"></path>
                    <path
                        d="M6.00002 10.75C5.69667 10.75 5.4232 10.5673 5.30711 10.287C5.19103 10.0068 5.25519 9.68417 5.46969 9.46967L11.4697 3.46967C11.6103 3.32902 11.8011 3.25 12 3.25C12.1989 3.25 12.3897 3.32902 12.5304 3.46967L18.5304 9.46967C18.7449 9.68417 18.809 10.0068 18.6929 10.287C18.5768 10.5673 18.3034 10.75 18 10.75L6.00002 10.75Z"
                        fill="currentColor"></path>
                </svg>
            </button>
        </template>
    </div>

    <!-- start theme customizer section -->
    {% include 'layout-new/customizer.html' %}
    <!-- end theme customizer section -->

    <div class="main-container min-h-screen text-black dark:text-white-dark" :class="[$store.app.navbar]">
        <!-- start sidebar section -->
        {% include 'layout-new/sidebar.html' %}
        <!-- end sidebar section -->

        <div class="main-content flex flex-col min-h-screen">
            <!-- start header section -->
            {% include 'layout-new/header.html' %}
            <!-- end header section -->

            <div class="animate__animated p-6" :class="[$store.app.animation]">
                <div x-data="finance">
                    <!-- Menampilkan nama pengguna yang login -->
                    <div class="mt-4 text-lg text-gray-300">
                        <!-- Jika hanya ingin menampilkan nama pengguna (username) -->
                        <div class="mt-4 text-lg text-gray-600"> Welcome, {{ user.first_name }} </div>
                    </div>
                    <div class="mb-5 flex items-center">
                        <!-- <h5 class="text-lg font-semibold dark:text-white-light">Mtd - Ore Class</h5> -->
                        <div x-data="form" class="dropdown ltr:ml-auto rtl:mr-auto">
                            <div class="inline-flex">
                                <div>
                                    <select id="filter_year" name="filter_year" class="form-select text-white-dark">
                                        <option value="">-- Year --</option>
                                    </select>
                                </div>

                                <div class="dropdown">
                                    <select id="filter_month" name="filter_month" class="form-select text-white-dark">
                                        <option value="">Month</option>
                                        <option value="1">Januari</option>
                                        <option value="2">Februari</option>
                                        <option value="3">Maret</option>
                                        <option value="4">April</option>
                                        <option value="5">Mei</option>
                                        <option value="6">Juni</option>
                                        <option value="7">Juli</option>
                                        <option value="8">Agustus</option>
                                        <option value="9">September</option>
                                        <option value="10">Oktober</option>
                                        <option value="11">November</option>
                                        <option value="12">Desember</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Card Top -->
                    {% include 'dashboard/mining/view_top.html' %}
                </div>

                <!-- Call Chart Month to Date -->
                {% include 'dashboard/mining/view_mine_mtd.html' %}

                <!-- call chart this week & last  5 week -->
                {% include 'dashboard/mining/view_mine_weekly.html' %}


            </div>

            <!-- start footer section -->
            <div class="p-6 pt-0 mt-auto text-center dark:text-white-dark ltr:sm:text-left rtl:sm:text-right">
                © <span id="footer-year">2022</span>. SQMS All rights reserved.
            </div>
            <!-- end footer section -->
        </div>
    </div>

    <!-- JAVASCRIPT -->
    {% include "layout-new/js.html" %}


    <script>
        // main section
        document.addEventListener('alpine:init', () => {
            // content section
            Alpine.data('finance', () => ({
                init() {
                    isDark = this.$store.app.theme === 'dark' || this.$store.app.isDarkMode ? true : false;
                    isRtl = this.$store.app.rtlClass === 'rtl' ? true : false;
                    const chartYeartoDate = null;
                    const chartDailytoMonth = null;
                    const chartHourstoDaysMtd = null;
                    const chartMaterialDailytoMonth = null;
                    const chartMaterialtoDays = null;
                    const chartMaterialtoWeekly = null;
                    const chartMaterialtoWeek = null;

                    // Pass Header Token
                    $.ajaxSetup({
                        headers: {
                            "X-CSRFToken": $('meta[name="csrf-token"]').attr("content"),
                        },
                    });

                    // Fetch year options for ore
                    $.ajax({
                        url: "{% url 'get-year-ore' %}",
                        method: "GET",
                        dataType: "json",
                        success: (data) => {
                            let options = "";
                            $.each(data.tahun_pds, (key, value) => {
                                options += `<option value="${value.tahun}">${value.tahun}</option>`;
                            });
                            $("#filter_year").append(options);
                            $("#filter_mtd_ore").append(options);
                        },
                    });

                    // Fetch year options for sale
                    $.ajax({
                        url: "{% url 'get-year-sale' %}",
                        method: "GET",
                        dataType: "json",
                        success: (data) => {
                            let options = "";
                            $.each(data.tahun, (key, value) => {
                                options += `<option value="${value.tahun}">${value.tahun}</option>`;
                            });
                            $("#filter_year_sale").append(options);
                            $("#filter_mtd_sale").append(options);
                        },
                    });

                    // Fetch initial data and update chart
                    this.fetchDataPtd();
                    this.createYtdChart();
                    this.createDailyChart();
                    this.createHoursChart();
                    this.createMaterialMonthChart();
                    this.createMaterialDaysChart();
                    this.createMaterialWeeklyChart();
                    this.createMaterialWeekChart();

                    this.chartYeartoDate = new ApexCharts(this.$refs.chartYeartoDate, this.barOptions);
                    this.$refs.chartYeartoDate.innerHTML = '';
                    this.chartYeartoDate.render();

                    //  by Mont to date


                    this.chartDailytoMonth = new ApexCharts(this.$refs.chartDailytoMonth, this.mixedChartOptions);
                    this.$refs.chartDailytoMonth.innerHTML = '';
                    this.chartDailytoMonth.render();

                    this.chartHourstoDays = new ApexCharts(this.$refs.chartHourstoDays, this.mixedChartOptions);
                    this.$refs.chartHourstoDays.innerHTML = '';
                    this.chartHourstoDays.render();

                    this.chartMaterialDailytoMonth = new ApexCharts(this.$refs.chartMaterialDailytoMonth, this.mixedChartOptions);
                    this.$refs.chartMaterialDailytoMonth.innerHTML = '';
                    this.chartMaterialDailytoMonth.render();

                    this.chartMaterialtoDays = new ApexCharts(this.$refs.chartMaterialtoDays, this.mixedChartOptions);
                    this.$refs.chartMaterialtoDays.innerHTML = '';
                    this.chartMaterialtoDays.render();

                    this.chartMaterialtoWeekly = new ApexCharts(this.$refs.chartMaterialtoWeekly, this.mixedChartOptions);
                    this.$refs.chartMaterialtoWeekly.innerHTML = '';
                    this.chartMaterialtoWeekly.render();

                    this.chartMaterialtoWeek = new ApexCharts(this.$refs.chartMaterialtoWeek, this.mixedChartOptions);
                    this.$refs.chartMaterialtoWeek.innerHTML = '';
                    this.chartMaterialtoWeek.render();


                    // Watch for theme changes
                    this.$watch('$store.app.theme', () => {
                        this.isDark = this.$store.app.theme === 'dark' || this.$store.app.isDarkMode ? true : false;
                        this.updateChartTheme();
                    });

                    // Watch for RTL changes
                    this.$watch('$store.app.rtlClass', () => {
                        this.isRtl = this.$store.app.rtlClass === 'rtl' ? true : false;
                        this.updateChartTheme();
                    });

                    // Fetch data when filter changes

                    document.getElementById('filter_year_sale').addEventListener('change', (event) => {
                        const selectedYearSale = event.target.value;
                        const filter = { filter_year: selectedYearSale };
                        this.createYtdChart(filter);
                    });


                    document.getElementById('saleDate').addEventListener('change', (event) => {
                        const selectedDate = event.target.value;
                        const filter = { filter_days: selectedDate };
                        this.createDailyChart(filter);
                    });


                    document.getElementById('filter_mtd_sale').addEventListener('change', (event) => {
                        const selectedYear = event.target.value;
                        const selectedMonth = $("#filter_month_sale").val();;
                        var filter = {
                            filter_year: selectedYear,
                            filter_month: selectedMonth
                        };
                        this.createHoursChart(filter);
                    });

                    document.getElementById('filter_month_sale').addEventListener('change', (event) => {
                        const selectedMonth = event.target.value;
                        const selectedYear = $("#filter_mtd_sale").val();;
                        var filter = {
                            filter_year: selectedYear,
                            filter_month: selectedMonth
                        };
                        this.createHoursChart(filter);
                    });


                },

                fetchDataPtd() {
                    $.ajax({
                        type: "GET",
                        url: '{% url "get-sale-ptd" %}',
                        success: function (data) {
                            // createLim(data)
                            var data_hpal = data.data_hpal;
                            var data_rkef = data.data_rkef;
                            var total_sale = data.total_sale;
                            var total = total_sale.reduce((acc, curr) => acc + curr, 0); // Hitung total data

                            var rkef_percentage = 0;
                            var hpal_percentage = 0;

                            // Periksa apakah total tidak nol sebelum menghitung persentase
                            if (total !== 0) {
                                rkef_percentage = (data_rkef / total) * 100;
                                hpal_percentage = (data_hpal / total) * 100;
                            }

                            function formatAngka(jumlah) {
                                if (jumlah >= 1_000_000_000) {
                                    return (jumlah / 1_000_000_000).toFixed(3) + ' B';
                                } else if (jumlah >= 1_000_000) {
                                    return (jumlah / 1_000_000).toFixed(3) + ' M';
                                } else if (jumlah >= 1_000) {
                                    return (jumlah / 1_000).toFixed(3) + ' K';
                                } else {
                                    return jumlah.toString();
                                }
                            }

                            $("#hpal_ptd").html(formatAngka(data_hpal));
                            $("#rkef_ptd").html(formatAngka(data_rkef));
                            $("#sale_ptd").html(formatAngka(total_sale));
                            $("#hpal_ptd_perc").html(hpal_percentage.toFixed(1) + '%');
                            $("#rkef_ptd_perc").html(rkef_percentage.toFixed(1) + '%');

                        },
                        error: function (xhr, errmsg, err) {
                            console.log("Error:", errmsg);
                        },
                    });
                },

                // Function Charts to fetch data from server 
                createYtdChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '',
                        data: filter,
                        success: (data) => { // Menggunakan arrow function di sini
                            // Panggil fungsi pembuatan grafik dengan data yang diperoleh
                            const x_data = data.x_data;
                            const y_data_actual = data.y_data_actual;
                            const y_data_plan = data.y_data_plan;

                            this.chartYeartoDate.updateOptions({

                                series: [
                                    {
                                        name: 'Actual',
                                        // data: y_data_actual
                                        data: [44, 55, 57, 56, 61, 58, 63, 60, 66]
                                    }, {
                                        name: 'Plan',
                                        // data: y_data_plan
                                        data: [35, 41, 36, 26, 45, 48, 52, 53, 41]
                                    }],
                                xaxis: {
                                    // categories: x_data,
                                    categories: ['Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                                },
                                colors: ['#ffc107', "#405a88", "#b9decf"],
                                title: {
                                    text: 'Production Mine - Ytd',
                                    align: 'left'
                                },
                                plotOptions: {
                                    bar: {
                                        horizontal: false,
                                        columnWidth: '55%',
                                        borderRadius: 5,
                                        borderRadiusApplication: 'end'
                                    },
                                },
                                dataLabels: {
                                    enabled: false
                                },
                                stroke: {
                                    show: true,
                                    width: 2,
                                    colors: ['transparent']
                                },


                            });

                        },
                        error: function (xhr, errmsg, err) {
                            console.log("Error:", errmsg);
                        },
                    });




                },

                createDailyChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '',
                        data: filter,
                        success: (data) => {
                            const x_data = data.x_data;
                            const y_data_plan = data.y_data_plan;
                            const y_data_actual = data.y_data_actual;

                            // Membuat data series untuk Actual
                            // var seriesDataActual = [];
                            // for (var i = 0; i < x_data.length; i++) {
                            //     seriesDataActual.push({
                            //         x: x_data[i],
                            //         y: y_data_plan[i],
                            //     });
                            // }

                            // // Membuat data series untuk Plan
                            // var seriesDataPlan = [];
                            // for (var i = 0; i < x_data.length; i++) {
                            //     seriesDataPlan.push({
                            //         x: x_data[i],
                            //         y: y_data_actual[i],
                            //     });
                            // }
                            // Mengatur ulang data kategori dan data seri
                            this.chartDailytoMonth.updateOptions({
                                // series: [
                                //     {
                                //         name: "Actual",
                                //         data: seriesDataActual,
                                //     },

                                //     {
                                //         name: "Plan",
                                //         data: seriesDataPlan,
                                //     },
                                // ],
                                series: [{
                                    name: 'Actual',
                                    type: 'column',
                                    data: [440, 505, 414, 671, 227, 413, 201, 352, 752, 320, 257, 160]
                                }, {
                                    name: 'Plan',
                                    type: 'line',
                                    data: [23, 42, 35, 27, 43, 22, 17, 31, 22, 22, 12, 16]
                                }],
                                colors: ["#AAC8A7", "#02b1a4", "#f3ce04", "#E48F45"],
                                labels: ['01 Nov 2024', '02 Nov 2024', '03 Nov 2024', '04 Nov 2024', '05 Nov 2024', '06 Nov 2024', '07 Nov 2024', '08 Nov 2024', '09 Nov 2024', '10 Nov 2024', '11 Nov 2024', '12 Nov 2024'],
                                yaxis: [{
                                    title: {
                                        text: 'Actual',
                                    },

                                },
                                {
                                    opposite: true,
                                    // title: {
                                    //     text: 'Plan'
                                    // }
                                }],
                                title: {
                                    text: 'Productions this Month'
                                },

                            });
                        },
                        error: function (error) {
                            console.error(error);
                        },
                    });
                },

                createHoursChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '',
                        data: filter,
                        success: (data) => {
                            const x_data = data.x_data;
                            const y_data = data.y_data;

                            // Mengatur ulang data kategori dan data seri
                            this.chartHourstoDays.updateOptions({
                                // series: data.x_data, // Gunakan data.x_data dari respons
                                // labels: data.y_data, // Gunakan data.y_data dari respons
                                // colors: ["#AAC8A7", "#02b1a4", "#f3ce04", "#E48F45"],
                                // dataLabels: {
                                //     enabled: false
                                // },

                                series: [
                                    {
                                        "name": "Actual",
                                        "type": "column",
                                        "data": [512, 472, 590, 623, 510, 0, 480, 511, 530, 610, 480, 520, 490, 500, 540, 580, 600, 0, 450, 410, 380, 400, 420, 390, 370]
                                    },
                                    {
                                        "name": "Plan",
                                        "type": "line",
                                        "data": [500, 480, 510, 520, 505, 490, 490, 500, 525, 515, 495, 505, 500, 510, 530, 540, 520, 480, 470, 450, 440, 460, 470, 460, 450]
                                    }
                                ],
                                labels: ['07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '00', '01', '02', '03', '04', '05', '06'],
                                // colors: ["#AAC8A7", "#02b1a4", "#f3ce04", "#E48F45"],
                                dataLabels: {
                                    enabled: true,
                                },
                                stroke: {
                                    width: [0, 3]
                                },
                                title: {
                                    text: 'Tracking - by Hours ',
                                    floating: true,
                                    offsetY: 0,
                                    align: 'center',
                                    style: {
                                        color: '#444'
                                    }
                                },
                                yaxis: [
                                    // {
                                    //     title: {
                                    //         text: 'Actual',
                                    //     },

                                    // },
                                    {
                                        opposite: true,

                                    }
                                ],
                                responsive: [{
                                    breakpoint: 400,
                                    options: {
                                        chart: {
                                            width: 340
                                        },
                                        legend: {
                                            show: false
                                        }
                                    }
                                }],

                            });
                        },
                        error: function (error) {
                            console.error(error);
                        },
                    });


                },

                // Get Data by Materials
                createMaterialMonthChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '',
                        data: filter,
                        success: (data) => {
                            const x_data = data.x_data;
                            const y_data = data.y_data;

                            // Mengatur ulang data kategori dan data seri
                            this.chartMaterialDailytoMonth.updateOptions({
                                // series: data.x_data, // Gunakan data.x_data dari respons
                                // labels: data.y_data, // Gunakan data.y_data dari respons
                                // colors: ["#AAC8A7", "#02b1a4", "#f3ce04", "#E48F45"],
                                // dataLabels: {
                                //     enabled: false
                                // },

                                series: [
                                    {
                                        "name": "Actual",
                                        "type": "column",
                                        "data": [512, 472, 590, 623, 510, 480, 511, 530, 610, 480, 520, 490, 370]
                                    },
                                    {
                                        "name": "Plan",
                                        "type": "line",
                                        "data": [500, 480, 510, 520, 505, 490, 490, 500, 525, 515, 495, 505, 510]
                                    }
                                ],
                                labels: ['TopSoil', 'OB', 'LGLO', 'MGLO', 'HGLO', 'Waste', 'MWS', 'LGSO', 'MGSO', 'HGSO', 'Quarry', 'Ballast', 'Biomass'],
                                colors: ["#AAC8A7", "#02b1a4", "#f3ce04", "#E48F45"],
                                dataLabels: {
                                    enabled: true,
                                },
                                stroke: {
                                    width: [0, 3]
                                },
                                title: {
                                    text: 'Material - by Month ',
                                    floating: true,
                                    offsetY: 0,
                                    align: 'center',
                                    style: {
                                        color: '#444'
                                    }
                                },
                                yaxis: [
                                    // {
                                    //     title: {
                                    //         text: 'Actual',
                                    //     },

                                    // },
                                    {
                                        opposite: true,

                                    }
                                ],
                                responsive: [{
                                    breakpoint: 400,
                                    options: {
                                        chart: {
                                            width: 340
                                        },
                                        legend: {
                                            show: false
                                        }
                                    }
                                }],

                            });
                        },
                        error: function (error) {
                            console.error(error);
                        },
                    });

                },

                createMaterialDaysChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '',
                        data: filter,
                        success: (data) => {
                            const x_data = data.x_data;
                            const y_data = data.y_data;

                            // Mengatur ulang data kategori dan data seri
                            this.chartMaterialtoDays.updateOptions({
                                // series: data.x_data, // Gunakan data.x_data dari respons
                                // labels: data.y_data, // Gunakan data.y_data dari respons
                                // colors: ["#AAC8A7", "#02b1a4", "#f3ce04", "#E48F45"],
                                // dataLabels: {
                                //     enabled: false
                                // },

                                series: [
                                    {
                                        "name": "Actual",
                                        "type": "column",
                                        "data": [512, 472, 590, 623, 510, 480, 511, 530, 610, 480, 520, 490, 370]
                                    },
                                    {
                                        "name": "Plan",
                                        "type": "line",
                                        "data": [500, 480, 510, 520, 505, 490, 490, 500, 525, 515, 495, 505, 510]
                                    }
                                ],
                                labels: ['TopSoil', 'OB', 'LGLO', 'MGLO', 'HGLO', 'Waste', 'MWS', 'LGSO', 'MGSO', 'HGSO', 'Quarry', 'Ballast', 'Biomass'],
                                // colors: ["#AAC8A7", "#02b1a4", "#f3ce04", "#E48F45"],
                                dataLabels: {
                                    enabled: true,
                                },
                                stroke: {
                                    width: [0, 3]
                                },
                                title: {
                                    text: 'Material - by Days ',
                                    floating: true,
                                    offsetY: 0,
                                    align: 'center',
                                    style: {
                                        color: '#444'
                                    }
                                },
                                yaxis: [
                                    // {
                                    //     title: {
                                    //         text: 'Actual',
                                    //     },

                                    // },
                                    {
                                        opposite: true,

                                    }
                                ],
                                responsive: [{
                                    breakpoint: 400,
                                    options: {
                                        chart: {
                                            width: 340
                                        },
                                        legend: {
                                            show: false
                                        }
                                    }
                                }],

                            });
                        },
                        error: function (error) {
                            console.error(error);
                        },
                    });

                },

                // For Weekly
                createMaterialWeeklyChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '',
                        data: filter,
                        success: (data) => {
                            const x_data = data.x_data;
                            const y_data = data.y_data;

                            // Mengatur ulang data kategori dan data seri
                            this.chartMaterialtoWeekly.updateOptions({
                                // series: data.x_data, // Gunakan data.x_data dari respons
                                // labels: data.y_data, // Gunakan data.y_data dari respons
                                // colors: ["#AAC8A7", "#02b1a4", "#f3ce04", "#E48F45"],
                                // dataLabels: {
                                //     enabled: false
                                // },

                                series: [
                                    {
                                        "name": "Actual",
                                        "type": "column",
                                        "data": [512, 472, 590, 623, 510, 480, 511, 530, 610, 480, 520, 490, 370]
                                    },
                                    {
                                        "name": "Plan",
                                        "type": "line",
                                        "data": [500, 480, 510, 520, 505, 490, 490, 500, 525, 515, 495, 505, 510]
                                    }
                                ],
                                labels: ['TopSoil', 'OB', 'LGLO', 'MGLO', 'HGLO', 'Waste', 'MWS', 'LGSO', 'MGSO', 'HGSO', 'Quarry', 'Ballast', 'Biomass'],
                                colors: ["#AAC8A7", "#02b1a4", "#f3ce04", "#E48F45"],
                                dataLabels: {
                                    enabled: true,
                                },
                                stroke: {
                                    width: [0, 3]
                                },
                                title: {
                                    text: 'Material on Weekly ',
                                    floating: true,
                                    offsetY: 0,
                                    align: 'center',
                                    style: {
                                        color: '#444'
                                    }
                                },
                                yaxis: [
                                    // {
                                    //     title: {
                                    //         text: 'Actual',
                                    //     },

                                    // },
                                    {
                                        opposite: true,

                                    }
                                ],
                                responsive: [{
                                    breakpoint: 400,
                                    options: {
                                        chart: {
                                            width: 340
                                        },
                                        legend: {
                                            show: false
                                        }
                                    }
                                }],

                            });
                        },
                        error: function (error) {
                            console.error(error);
                        },
                    });

                },

                createMaterialWeekChart(filter = {}) {
                    $.ajax({
                        type: "GET",
                        url: '',
                        data: filter,
                        success: (data) => {
                            const x_data = data.x_data;
                            const y_data = data.y_data;

                            // Mengatur ulang data kategori dan data seri
                            this.chartMaterialtoWeek.updateOptions({
                                // series: data.x_data, // Gunakan data.x_data dari respons
                                // labels: data.y_data, // Gunakan data.y_data dari respons
                                // colors: ["#AAC8A7", "#02b1a4", "#f3ce04", "#E48F45"],
                                // dataLabels: {
                                //     enabled: false
                                // },

                                series: [
                                    {
                                        "name": "Actual",
                                        "type": "column",
                                        "data": [512, 472, 590, 623, 510, 480, 511, 530, 610, 480, 520, 490, 370]
                                    },
                                    {
                                        "name": "Plan",
                                        "type": "line",
                                        "data": [500, 480, 510, 520, 505, 490, 490, 500, 525, 515, 495, 505, 510]
                                    }
                                ],
                                labels: ['TopSoil', 'OB', 'LGLO', 'MGLO', 'HGLO', 'Waste', 'MWS', 'LGSO', 'MGSO', 'HGSO', 'Quarry', 'Ballast', 'Biomass'],
                                // colors: ["#AAC8A7", "#02b1a4", "#f3ce04", "#E48F45"],
                                dataLabels: {
                                    enabled: true,
                                },
                                stroke: {
                                    width: [0, 3]
                                },
                                title: {
                                    text: 'Material this week ',
                                    floating: true,
                                    offsetY: 0,
                                    align: 'center',
                                    style: {
                                        color: '#444'
                                    }
                                },
                                yaxis: [
                                    // {
                                    //     title: {
                                    //         text: 'Actual',
                                    //     },

                                    // },
                                    {
                                        opposite: true,

                                    }
                                ],
                                responsive: [{
                                    breakpoint: 400,
                                    options: {
                                        chart: {
                                            width: 340
                                        },
                                        legend: {
                                            show: false
                                        }
                                    }
                                }],

                            });
                        },
                        error: function (error) {
                            console.error(error);
                        },
                    });

                },


                updateChartTheme() {
                    this.chartYeartoDate.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                        xaxis: {
                            axisBorder: { show: true, color: this.isDark ? '#3b3f5c' : '#e0e6ed' },
                        },
                    });
                    this.chartDailytoMonth.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                        // xaxis: {
                        //     axisBorder: { show: true, color: this.isDark ? '#3b3f5c' : '#e0e6ed' },
                        // },
                    });
                    this.chartHourstoDays.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                        // xaxis: {
                        //     axisBorder: { show: true, color: this.isDark ? '#3b3f5c' : '#e0e6ed' },
                        // },
                    });

                    this.chartMaterialDailytoMonth.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                    });
                    this.chartMaterialtoDays.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                    });

                    this.chartMaterialtoWeekly.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                    });
                    this.chartMaterialtoWeek.updateOptions({
                        grid: {
                            borderColor: this.isDark ? '#191e3a' : '#e0e6ed',
                        },
                    });

                },

                get barOptions() {
                    return {
                        series: [
                            { name: 'HPAL', data: [] },
                            { name: 'RKEF', data: [] }
                        ],
                        chart: {
                            height: 320,
                            type: 'bar',
                            fontFamily: 'Nunito, sans-serif',
                            toolbar: {
                                show: false,
                            },
                        },
                        dataLabels: {
                            enabled: false,
                        },
                        stroke: {
                            width: 2,
                            colors: ['transparent'],
                        },
                        // colors: ['#5c1ac3', '#5c739a', '#ffbb44'],
                        colors: ['#ffca2c', '#5c739a', '#5c1ac3', '#ffbb44'],
                        // colors: ['#ffc107', '#546ea2', '#5c739a'],
                        dropShadow: {
                            enabled: true,
                            blur: 3,
                            color: '#515365',
                            opacity: 0.4,
                        },
                        plotOptions: {
                            bar: {
                                horizontal: false,
                                columnWidth: '70%',
                                borderRadius: 0,
                            },
                        },
                        legend: {
                            position: 'bottom',
                            horizontalAlign: 'center',
                            fontSize: '14px',
                            itemMargin: {
                                horizontal: 8,
                                vertical: 8,
                            },
                        },
                        grid: {
                            borderColor: isDark ? '#191e3a' : '#e0e6ed',
                            padding: {
                                left: 20,
                                right: 20,
                            },
                        },
                        xaxis: {
                            categories: [],
                            axisBorder: {
                                show: true,
                                color: isDark ? '#3b3f5c' : '#e0e6ed',
                            },
                        },
                        yaxis: {
                            tickAmount: 4,
                            labels: {
                                formatter: (value) => {
                                    return value / 1000 + 'K';
                                },
                                offsetX: isRtl ? -10 : 0,
                                offsetY: 0,
                                style: {
                                    fontSize: '12px',
                                    cssClass: 'apexcharts-yaxis-title',
                                },
                            },
                            opposite: isRtl ? true : false,
                        },
                        fill: {

                        },
                        tooltip: {
                            marker: {
                                show: true,
                            },
                            y: {
                                formatter: (val) => {
                                    return val;
                                },
                            },
                        },
                        noData: {
                            text: "No Data...",
                        },
                    };
                },

                // area chart
                get dailyChartOptions() {
                    return {
                        series: [
                            {
                                name: 'HPAL',
                                data: [],
                            },
                            {
                                name: 'REKF',
                                data: [],
                            },
                        ],
                        chart: {
                            height: 335,
                            type: 'area',
                            fontFamily: 'Nunito, sans-serif',
                            zoom: {
                                enabled: false,
                            },
                            toolbar: {
                                show: false,
                            },
                        },
                        dataLabels: {
                            enabled: false,
                        },
                        stroke: {
                            show: true,
                            curve: 'smooth',
                            width: 2,
                            lineCap: 'square',
                        },
                        dropShadow: {
                            enabled: true,
                            opacity: 0.2,
                            blur: 10,
                            left: -7,
                            top: 22,
                        },
                        //  colors: isDark ? ['#2196f3', '#e7515a'] : ['#1b55e2', '#e7515a'],
                        colors: ['#f4c63d', '#17a2b8'],

                        labels: [],
                        xaxis: {
                            axisBorder: {
                                show: false,
                            },
                            axisTicks: {
                                show: false,
                            },
                            crosshairs: {
                                show: true,
                            },
                            labels: {
                                offsetX: isRtl ? 2 : 0,
                                offsetY: 5,
                                style: {
                                    fontSize: '12px',
                                    cssClass: 'apexcharts-xaxis-title',
                                },
                            },
                        },
                        yaxis: {
                            tickAmount: 5,
                            labels: {
                                formatter: (value) => {
                                    return value / 1000 + 'K';
                                },
                                offsetX: isRtl ? -30 : -10,
                                offsetY: 0,
                                style: {
                                    fontSize: '12px',
                                    cssClass: 'apexcharts-yaxis-title',
                                },
                            },
                            opposite: isRtl ? true : false,
                        },
                        grid: {
                            borderColor: isDark ? '#191e3a' : '#e0e6ed',
                            strokeDashArray: 0,
                            xaxis: {
                                lines: {
                                    show: false,
                                },
                            },
                            yaxis: {
                                lines: {
                                    show: true,
                                },
                            },
                            padding: {
                                top: 0,
                                right: 0,
                                bottom: 0,
                                left: 0,
                            },
                        },
                        legend: {
                            position: 'top',
                            horizontalAlign: 'right',
                            fontSize: '16px',
                            markers: {
                                width: 10,
                                height: 10,
                                offsetX: -2,
                            },
                            itemMargin: {
                                horizontal: 10,
                                vertical: 5,
                            },
                        },
                        tooltip: {
                            marker: {
                                show: true,
                            },
                            x: {
                                show: false,
                            },
                        },
                        fill: {
                            type: 'gradient',
                            gradient: {
                                shadeIntensity: 1,
                                inverseColors: !1,
                                opacityFrom: isDark ? 0.19 : 0.28,
                                opacityTo: 0.05,
                                stops: isDark ? [100, 100] : [45, 100],
                            },
                        },
                    };
                },

                get donutChartOptions() {
                    return {
                        series: [],
                        chart: {
                            height: 290,
                            type: 'donut',
                            zoom: {
                                enabled: false
                            },
                            toolbar: {
                                show: false
                            }
                        },
                        stroke: {
                            show: false,
                        },
                        labels: [],
                        colors: [],
                        responsive: [{
                            breakpoint: 400,
                            options: {
                                chart: {
                                    width: 320
                                }
                            }
                        }],
                        legend: {
                            position: 'bottom',
                        },
                    }
                },

                get mixedChartOptions() {
                    return {
                        series: [],
                        chart: {
                            height: 350,
                            type: 'line',
                            fontFamily: 'Nunito, sans-serif',
                            zoom: {
                                enabled: false,
                            },
                            toolbar: {
                                show: false,
                            },
                        },
                        stroke: {
                            width: [0, 3]
                        },
                        title: {
                            text: 'Mine Productions'
                        },
                        dataLabels: {
                            enabled: true,
                            enabledOnSeries: [1]
                        },
                        labels: [],
                        yaxis: []
                    };

                },
            }));

        });
    </script>

</body>

</html>

<style>
    .scrollbar-sm {
        overflow-x: hidden;
        /* Scroll disembunyikan secara default */
        transition: overflow 0.3s;
        scroll-behavior: smooth;
        /* Scroll smooth */
        -webkit-overflow-scrolling: touch;
        /* Smooth scroll untuk iOS */
        margin-top: 16px;
        margin-bottom: 16px;
    }

    .scrollbar-sm:hover {
        overflow-x: auto;
        /* Scroll muncul saat hover */
    }

    .scrollbar-sm::-webkit-scrollbar {
        height: 6px;
        /* Scroll kecil */
    }

    .scrollbar-sm::-webkit-scrollbar-thumb {
        background-color: #888;
        border-radius: 3px;
    }

    .scrollbar-sm::-webkit-scrollbar-thumb:hover {
        background-color: #555;
    }

    @media (max-width: 768px) {
        .scrollbar-sm {
            display: flex;
            overflow-x: auto;
            padding-left: 8px;
            /* Perkecil padding */
            padding-right: 8px;
        }

        .scrollbar-sm>div {
            min-width: 150px;
            /* Sesuaikan ukuran card */
        }
    }
</style>